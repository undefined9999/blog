(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{242:function(t,s,n){},282:function(t,s,n){"use strict";var i=n(242);n.n(i).a},371:function(t,s,n){"use strict";n.r(s);var i={data:function(){return{chunks:[],chunkList:[],btnText:"按住说话"}},methods:{requestMediaAccess:function(){var t=this;navigator.mediaDevices.getUserMedia({audio:!0}).then(function(s){t.recorder=new window.MediaRecorder(s),t.bindEvents()},function(t){alert("出错，请确保已允许浏览器获取录音权限")})},onMousedown:function(t){this.onStart(),this.btnText="松开结束"},onMouseup:function(){this.onStop(),this.btnText="按住说话"},onStart:function(){this.recorder.start()},onStop:function(){this.recorder.stop()},onPlay:function(t){var s=this;this.chunkList.forEach(function(t){s.$set(t,"wink",!1)});var n=this.chunkList[t];this.audio.src=n.stream,this.audio.play(),this.bindAudioEvent(t)},bindAudioEvent:function(t){var s=this,n=this.chunkList[t];this.audio.onplaying=function(){s.$set(n,"wink",!0)},this.audio.onended=function(){s.$set(n,"wink",!1)}},bindEvents:function(){this.recorder.ondataavailable=this.getRecordingData,this.recorder.onstop=this.saveRecordingData},getRecordingData:function(t){this.chunks.push(t.data)},saveRecordingData:function(){var t=new Blob(this.chunks,{type:"audio/ogg; codecs=opus"}),s=URL.createObjectURL(t),n=parseInt(t.size/6600);n<=0?alert("说话时间太短"):(n>60&&(n=60),this.chunkList.push({duration:n,stream:s}),this.msgList.scrollBy&&this.msgList.scrollBy({top:200,left:0,behavior:"smooth"}),this.chunks=[])}},mounted:function(){navigator.mediaDevices?window.MediaRecorder?(this.audio=this.$refs.audio,this.msgList=document.querySelector(".js-msg-list"),this.requestMediaAccess()):alert("您的浏览器不支持录音"):alert("您的浏览器不支持获取用户设备")}},e=(n(282),n(1)),a=Object(e.a)(i,function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"recorder-wrapper"},[n("div",{staticClass:"phone"},[n("div",{staticClass:"phone-body"},[t._m(0),n("div",{staticClass:"phone-content"},[n("transition-group",{staticClass:"js-msg-list msg-list",attrs:{tag:"ul",name:"fade"}},[n("li",{key:-1,staticClass:"msg eg"},[n("div",{staticClass:"avatar"}),n("div",{staticClass:"audio"},[t._v("说话")])]),t._l(t.chunkList,function(s,i){return n("li",{key:i,staticClass:"msg",on:{click:function(s){t.onPlay(i)},touchend:function(s){s.preventDefault(),t.onPlay(i)}}},[n("div",{staticClass:"avatar"}),n("div",{staticClass:"audio",class:{wink:s.wink},style:{width:20*s.duration+"px"}},[n("span",[t._v("(")]),n("span",[t._v("(")]),n("span",[t._v("(")])]),n("div",{staticClass:"duration"},[t._v(t._s(s.duration)+'"')])])})],2)],1),n("div",{staticClass:"phone-operate",on:{mousedown:t.onMousedown,touchstart:function(s){return s.preventDefault(),t.onMousedown(s)},mouseup:t.onMouseup,touchend:function(s){return s.preventDefault(),t.onMouseup(s)}}},[t._v(t._s(t.btnText))])])]),n("audio",{ref:"audio"})])},[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"phone-head"},[s("span",[this._v("< 微信(66)")]),s("span",[this._v("哈哈哈")]),s("span",[this._v("···")])])}],!1,null,"2aefe4e1",null);s.default=a.exports}}]);